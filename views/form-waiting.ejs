<h2>Payment Queue</h2>

<% if (qr_link) { %>
  <p>✅ Your turn! Please scan and pay:</p>
  <img src="<%= qr_link %>" alt="QR Code">
  <p>UPI: <%= qr_upi %></p>
<% } else { %>
  <p>🚦 Someone else is paying ₹<%= amount %>. Please wait for your turn.</p>
  <p>⏱️ This page will refresh automatically after <span id="timer">05:00</span></p>

  <script>
    let seconds = 300;
    const timerEl = document.getElementById("timer");

    function updateTimer() {
      let min = Math.floor(seconds / 60);
      let sec = seconds % 60;
      timerEl.textContent = `${min.toString().padStart(2, '0')}:${sec.toString().padStart(2, '0')}`;
      if (seconds > 0) {
        seconds--;
        setTimeout(updateTimer, 1000);
      } else {
        location.reload(); // ⟳ Refresh after 5 minutes
      }
    }

    updateTimer();
  </script>
<% } %>
